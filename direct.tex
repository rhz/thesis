In this chapter we show how to construct a set of reversible rules
and their forward and backward rate constants from an energy function.
In the spirit of rule-based modelling languages like Kappa
where rules and observables are defined in terms of patterns ---
contact maps $g$ used to match a state $m$ ---
we use a set of \emph{energy patterns} $\shapes$
in our energy function.
We assign an \emph{energy cost} $\cost(g)$ to pattern $g$
and construct energy functions as linear combinations
of the number of ocurrences of each energy pattern.
\[ E(m) = \sum_{g \in \shapes} \cost(g) \abs{\matches{g}{m}} \]
This is reminiscent of group contribution methods
used to estimate the standard Gibbs free energy of formation
of biomolecules \citep{group-contrib}.

In our previous example (\sct{kappa}) we might want to favour
the formation of triangles over chains and other cycles.
For this we would give a negative energy cost to $t$,
\ie $\cost(t) < 0$.
If $t$ is the only energy pattern,
then the energy of a state $m$ is
$E(m) = \cost(t) \abs{\matches{t}{m}}$.
% In this model we might want to know, for instance,
In this model one might wonder, for instance,
how low the energy cost of $t$ must be
to have at least $90\%$ of all agents in a triangle
at equilibrium at least $90\%$ of the time.

As mentioned at the end of \sct{kappa},
we will derive the set of rules with detailed balance
from a set of generator rules $\generators$ (without rates).
Given a contact graph $C$,
a simple option would be to include
every possible minimal rule in this set,
that is, include a creation and destruction rule
for each edge in the contact graph
that only asks for the presence of
the two participating agents and sites.
The example rule in \sct{kappa},
where agents of type $1$ and $2$ bind
% regardless of the binding state of any other site,
regardless of the context
in which these two agents happen to be,
% (call it $r^+_{12}$)
is one such minimal rule
that can be derived from contact graph $T$.
This option is \emph{maximally permissive}
% as every possible transformation
% allowed by the contact graph
% is allowed by $\generators$.\footnote{
with respect to the contact graph.\footnote{
  Intuitively, this is analogous to the case of classical mechanics
  % where the topology of the space gives us the possible transformations
  where, a priori, movement is not constrained along in coordinate.}
Even if all transformations are possible,
many of them may be unlikely due to having a high energy.
However, one might prefer to forbid certain transformations
in some scenarios.
This is indeed the case in the example
that will be presented in \sct{alloring}.







\if0
We suppose hereafter that $\generators$ is closed under
rule inversion, \ie $\generators = \inv{\generators}$.
Hence every $(r,\psi)$-transition
has an inverse $(\inv{r},\comatch{\psi})$
and $\LTS_\generators$ is symmetric.


\section{Minimal glueings}
\label{sec:mg}


\section{Refinements} % and growth policies
\label{sec:gp}
\fi


\section{Energy-based refinement}
\label{sec:energy-gp}


\section{Linear kinetic model}
\label{sec:kinetic-model}

% is the linear kinetic model related to "Parameters for
% the description of transition states", John Leffler, Science, 1953
% https://sci-hub.ac/10.2307/1680906
% it says "we approximate the transition state as a hybrid between
% the reagent and product states"
% "whenever the plot of the logarithm of the rate constant
%  against the equilibrium constant is a straight line,
%  the approximation is justified"
% "it should then be possible to predict
%  the free energy of the transition state by a linear combination of
%  the predictions made for the reagents and for the products"
%
% if we then relate the free energy of the transition state to
% the rate constants using Arrhenius?
% this has been done in transition state theory
% https://en.wikipedia.org/wiki/Eyring_equation
%
% do we get additional constraints on kinetic rates from cycles
% in the transition graph? when two cycles share an edge?


\section{Flagellum's motor}
\label{sec:alloring}




%%% Local Variables:
%%% mode: latex
%%% TeX-master: "thesis"
%%% End:
